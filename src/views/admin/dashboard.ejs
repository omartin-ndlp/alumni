<div class="row">
    <div class="col-12">
        <div class="d-flex justify-content-between align-items-center mb-4">
            <h1><%= __('admin.dashboard.title') %></h1>
            <span class="text-muted"><%= __('admin.dashboard.welcome', { prenom: user.prenom }) %></span>
        </div>
    </div>
</div>

<% if (isAdmin) { %>
<div class="row">
    <div class="col-md-4 mb-4">
        <div class="card h-100">
            <div class="card-body text-center">
                <i class="bi bi-person-plus text-warning" style="font-size: 3rem;"></i>
                <h5 class="card-title mt-3"><%= __('admin.dashboard.pendingRequests.title') %></h5>
                <p class="card-text"><%= __('admin.dashboard.pendingRequests.description') %></p>
                <a href="/admin/requests" class="btn btn-warning">
                    <i class="bi bi-hourglass-split"></i> <%= __('admin.dashboard.pendingRequests.button') %>
                </a>
            </div>
        </div>
    </div>

    <div class="col-md-4 mb-4">
        <div class="card h-100">
            <div class="card-body text-center">
                <i class="bi bi-collection text-info" style="font-size: 3rem;"></i>
                <h5 class="card-title mt-3"><%= __('admin.dashboard.sectionManagement.title') %></h5>
                <p class="card-text"><%= __('admin.dashboard.sectionManagement.description') %></p>
                <a href="/admin/sections" class="btn btn-info">
                    <i class="bi bi-gear"></i> <%= __('admin.dashboard.sectionManagement.button') %>
                </a>
            </div>
        </div>
    </div>

    <div class="col-md-4 mb-4">
        <div class="card h-100">
            <div class="card-body text-center">
                <i class="bi bi-bar-chart-line text-primary" style="font-size: 3rem;"></i>
                <h5 class="card-title mt-3"><%= __('admin.dashboard.statistics.title') %></h5>
                <p class="card-text"><%= __('admin.dashboard.statistics.description') %></p>
                <a href="/admin/statistics" class="btn btn-primary">
                    <i class="bi bi-eye"></i> <%= __('admin.dashboard.statistics.button') %>
                </a>
            </div>
        </div>
    </div>

    <div class="col-md-4 mb-4">
        <div class="card h-100">
            <div class="card-body text-center">
                <i class="bi bi-building text-success" style="font-size: 3rem;"></i>
                <h5 class="card-title mt-3"><%= __('admin.dashboard.employerExport.title') %></h5>
                <p class="card-text"><%= __('admin.dashboard.employerExport.description') %></p>
                <a href="/admin/export/employers" class="btn btn-success">
                    <i class="bi bi-download"></i> <%= __('admin.dashboard.employerExport.button') %>
                </a>
            </div>
        </div>
    </div>
</div>
<% } %>

<% if (recentUsers && recentUsers.length > 0) { %>
<div class="row mt-5">
    <div class="col-12">
        <h3><%= __('admin.dashboard.newMembers') %></h3>
        <div class="row">
            <% recentUsers.forEach(user => {
            %>
            <div class="col-md-6 col-lg-4 mb-3">
                <div class="card">
                    <div class="card-body">
                        <div class="d-flex align-items-center">
                            <img src="<%= User.getGravatarUrl(user.email, 50) %>" class="rounded-circle me-3 gravatar-img" 
                                 style="width: 50px; height: 50px; object-fit: cover;">
                            <div>
                                <h6 class="mb-0"><a href="/users/<%= user.id %>"><%= user.prenom %> <%= user.nom %></a></h6>
                                <small class="text-muted"><%= user.section_nom %>, <%= user.annee_diplome %></small>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <% }) %>
        </div>
    </div>
</div>
<% } %>

<script>
document.addEventListener('DOMContentLoaded', function() {
    // Handle Gravatar image loading
    document.querySelectorAll('.gravatar-img').forEach(img => {
        img.addEventListener('error', function() {
            this.classList.add('d-none'); // Hide the image on error
        });
    });
});
</script>